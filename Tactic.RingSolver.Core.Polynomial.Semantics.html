<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>Tactic.RingSolver.Core.Polynomial.Semantics</title><link rel="stylesheet" href="Agda.css"></head><body><pre class="Agda"><a id="1" class="Comment">------------------------------------------------------------------------</a>
<a id="74" class="Comment">-- The Agda standard library</a>
<a id="103" class="Comment">--</a>
<a id="106" class="Comment">-- &quot;Evaluating&quot; a polynomial, using Horner&#39;s method.</a>
<a id="159" class="Comment">------------------------------------------------------------------------</a>

<a id="233" class="Symbol">{-#</a> <a id="237" class="Keyword">OPTIONS</a> <a id="245" class="Pragma">--without-K</a> <a id="257" class="Pragma">--safe</a> <a id="264" class="Symbol">#-}</a>

<a id="269" class="Keyword">open</a> <a id="274" class="Keyword">import</a> <a id="281" href="Tactic.RingSolver.Core.Polynomial.Parameters.html" class="Module">Tactic.RingSolver.Core.Polynomial.Parameters</a>

<a id="327" class="Keyword">module</a> <a id="334" href="Tactic.RingSolver.Core.Polynomial.Semantics.html" class="Module">Tactic.RingSolver.Core.Polynomial.Semantics</a>
  <a id="380" class="Symbol">{</a><a id="381" href="Tactic.RingSolver.Core.Polynomial.Semantics.html#381" class="Bound">r₁</a> <a id="384" href="Tactic.RingSolver.Core.Polynomial.Semantics.html#384" class="Bound">r₂</a> <a id="387" href="Tactic.RingSolver.Core.Polynomial.Semantics.html#387" class="Bound">r₃</a> <a id="390" href="Tactic.RingSolver.Core.Polynomial.Semantics.html#390" class="Bound">r₄</a><a id="392" class="Symbol">}</a>
  <a id="396" class="Symbol">(</a><a id="397" href="Tactic.RingSolver.Core.Polynomial.Semantics.html#397" class="Bound">homo</a> <a id="402" class="Symbol">:</a> <a id="404" href="Tactic.RingSolver.Core.Polynomial.Parameters.html#1104" class="Record">Homomorphism</a> <a id="417" href="Tactic.RingSolver.Core.Polynomial.Semantics.html#381" class="Bound">r₁</a> <a id="420" href="Tactic.RingSolver.Core.Polynomial.Semantics.html#384" class="Bound">r₂</a> <a id="423" href="Tactic.RingSolver.Core.Polynomial.Semantics.html#387" class="Bound">r₃</a> <a id="426" href="Tactic.RingSolver.Core.Polynomial.Semantics.html#390" class="Bound">r₄</a><a id="428" class="Symbol">)</a>
  <a id="432" class="Keyword">where</a>

<a id="439" class="Keyword">open</a> <a id="444" class="Keyword">import</a> <a id="451" href="Data.Nat.html" class="Module">Data.Nat</a>     <a id="464" class="Keyword">using</a> <a id="470" class="Symbol">(</a><a id="471" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a><a id="472" class="Symbol">;</a> <a id="474" href="Agda.Builtin.Nat.html#223" class="InductiveConstructor">suc</a><a id="477" class="Symbol">;</a> <a id="479" href="Agda.Builtin.Nat.html#210" class="InductiveConstructor">zero</a><a id="483" class="Symbol">;</a> <a id="485" href="Data.Nat.Base.html#3740" class="Datatype Operator">_≤′_</a><a id="489" class="Symbol">;</a> <a id="491" href="Data.Nat.Base.html#3814" class="InductiveConstructor">≤′-step</a><a id="498" class="Symbol">;</a> <a id="500" href="Data.Nat.Base.html#3771" class="InductiveConstructor">≤′-refl</a><a id="507" class="Symbol">)</a>
<a id="509" class="Keyword">open</a> <a id="514" class="Keyword">import</a> <a id="521" href="Data.Vec.html" class="Module">Data.Vec</a>     <a id="534" class="Keyword">using</a> <a id="540" class="Symbol">(</a><a id="541" href="Data.Vec.Base.html#959" class="Datatype">Vec</a><a id="544" class="Symbol">;</a> <a id="546" href="Data.Vec.Base.html#995" class="InductiveConstructor">[]</a><a id="548" class="Symbol">;</a> <a id="550" href="Data.Vec.Base.html#1014" class="InductiveConstructor Operator">_∷_</a><a id="553" class="Symbol">;</a> <a id="555" href="Data.Vec.Base.html#7211" class="Function">uncons</a><a id="561" class="Symbol">)</a>
<a id="563" class="Keyword">open</a> <a id="568" class="Keyword">import</a> <a id="575" href="Data.List.html" class="Module">Data.List</a>    <a id="588" class="Keyword">using</a> <a id="594" class="Symbol">(</a><a id="595" href="Data.List.Base.html#9981" class="InductiveConstructor">[]</a><a id="597" class="Symbol">;</a> <a id="599" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">_∷_</a><a id="602" class="Symbol">)</a>
<a id="604" class="Keyword">open</a> <a id="609" class="Keyword">import</a> <a id="616" href="Data.Product.html" class="Module">Data.Product</a> <a id="629" class="Keyword">using</a> <a id="635" class="Symbol">(</a><a id="636" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">_,_</a><a id="639" class="Symbol">;</a> <a id="641" href="Data.Product.html#1167" class="Function Operator">_×_</a><a id="644" class="Symbol">)</a>
<a id="646" class="Keyword">open</a> <a id="651" class="Keyword">import</a> <a id="658" href="Data.List.Kleene.html" class="Module">Data.List.Kleene</a> <a id="675" class="Keyword">using</a> <a id="681" class="Symbol">(</a><a id="682" href="Data.List.Kleene.Base.html#1533" class="Record Operator">_+</a><a id="684" class="Symbol">;</a> <a id="686" href="Data.List.Kleene.Base.html#1565" class="Datatype Operator">_*</a><a id="688" class="Symbol">;</a> <a id="690" href="Data.List.Kleene.Base.html#1750" class="InductiveConstructor Operator">∹_</a><a id="692" class="Symbol">;</a> <a id="694" href="Data.List.Kleene.Base.html#1656" class="InductiveConstructor Operator">_&amp;_</a><a id="697" class="Symbol">;</a> <a id="699" href="Data.List.Kleene.Base.html#1739" class="InductiveConstructor">[]</a><a id="701" class="Symbol">)</a>

<a id="704" class="Keyword">open</a> <a id="709" href="Tactic.RingSolver.Core.Polynomial.Parameters.html#1104" class="Module">Homomorphism</a> <a id="722" href="Tactic.RingSolver.Core.Polynomial.Semantics.html#397" class="Bound">homo</a>
<a id="727" class="Keyword">open</a> <a id="732" class="Keyword">import</a> <a id="739" href="Tactic.RingSolver.Core.Polynomial.Base.html" class="Module">Tactic.RingSolver.Core.Polynomial.Base</a> <a id="778" href="Tactic.RingSolver.Core.Polynomial.Parameters.html#1179" class="Field">from</a>
<a id="783" class="Keyword">open</a> <a id="788" class="Keyword">import</a> <a id="795" href="Algebra.Operations.Ring.html" class="Module">Algebra.Operations.Ring</a> <a id="819" href="Tactic.RingSolver.Core.AlmostCommutativeRing.html#2258" class="Function">rawRing</a>

<a id="drop"></a><a id="828" href="Tactic.RingSolver.Core.Polynomial.Semantics.html#828" class="Function">drop</a> <a id="833" class="Symbol">:</a> <a id="835" class="Symbol">∀</a> <a id="837" class="Symbol">{</a><a id="838" href="Tactic.RingSolver.Core.Polynomial.Semantics.html#838" class="Bound">i</a> <a id="840" href="Tactic.RingSolver.Core.Polynomial.Semantics.html#840" class="Bound">n</a><a id="841" class="Symbol">}</a> <a id="843" class="Symbol">→</a> <a id="845" href="Tactic.RingSolver.Core.Polynomial.Semantics.html#838" class="Bound">i</a> <a id="847" href="Data.Nat.Base.html#3740" class="Datatype Operator">≤′</a> <a id="850" href="Tactic.RingSolver.Core.Polynomial.Semantics.html#840" class="Bound">n</a> <a id="852" class="Symbol">→</a> <a id="854" href="Data.Vec.Base.html#959" class="Datatype">Vec</a> <a id="858" href="Tactic.RingSolver.Core.AlmostCommutativeRing.html#1379" class="Function">Carrier</a> <a id="866" href="Tactic.RingSolver.Core.Polynomial.Semantics.html#840" class="Bound">n</a> <a id="868" class="Symbol">→</a> <a id="870" href="Data.Vec.Base.html#959" class="Datatype">Vec</a> <a id="874" href="Tactic.RingSolver.Core.AlmostCommutativeRing.html#1379" class="Function">Carrier</a> <a id="882" href="Tactic.RingSolver.Core.Polynomial.Semantics.html#838" class="Bound">i</a>
<a id="884" href="Tactic.RingSolver.Core.Polynomial.Semantics.html#828" class="Function">drop</a> <a id="889" href="Data.Nat.Base.html#3771" class="InductiveConstructor">≤′-refl</a>         <a id="905" href="Tactic.RingSolver.Core.Polynomial.Semantics.html#905" class="Bound">xs</a>       <a id="914" class="Symbol">=</a> <a id="916" href="Tactic.RingSolver.Core.Polynomial.Semantics.html#905" class="Bound">xs</a>
<a id="919" href="Tactic.RingSolver.Core.Polynomial.Semantics.html#828" class="Function">drop</a> <a id="924" class="Symbol">(</a><a id="925" href="Data.Nat.Base.html#3814" class="InductiveConstructor">≤′-step</a> <a id="933" href="Tactic.RingSolver.Core.Polynomial.Semantics.html#933" class="Bound">i+1≤n</a><a id="938" class="Symbol">)</a> <a id="940" class="Symbol">(_</a> <a id="943" href="Data.Vec.Base.html#1014" class="InductiveConstructor Operator">∷</a> <a id="945" href="Tactic.RingSolver.Core.Polynomial.Semantics.html#945" class="Bound">xs</a><a id="947" class="Symbol">)</a> <a id="949" class="Symbol">=</a> <a id="951" href="Tactic.RingSolver.Core.Polynomial.Semantics.html#828" class="Function">drop</a> <a id="956" href="Tactic.RingSolver.Core.Polynomial.Semantics.html#933" class="Bound">i+1≤n</a> <a id="962" href="Tactic.RingSolver.Core.Polynomial.Semantics.html#945" class="Bound">xs</a>

<a id="drop-1"></a><a id="966" href="Tactic.RingSolver.Core.Polynomial.Semantics.html#966" class="Function">drop-1</a> <a id="973" class="Symbol">:</a> <a id="975" class="Symbol">∀</a> <a id="977" class="Symbol">{</a><a id="978" href="Tactic.RingSolver.Core.Polynomial.Semantics.html#978" class="Bound">i</a> <a id="980" href="Tactic.RingSolver.Core.Polynomial.Semantics.html#980" class="Bound">n</a><a id="981" class="Symbol">}</a> <a id="983" class="Symbol">→</a> <a id="985" href="Agda.Builtin.Nat.html#223" class="InductiveConstructor">suc</a> <a id="989" href="Tactic.RingSolver.Core.Polynomial.Semantics.html#978" class="Bound">i</a> <a id="991" href="Data.Nat.Base.html#3740" class="Datatype Operator">≤′</a> <a id="994" href="Tactic.RingSolver.Core.Polynomial.Semantics.html#980" class="Bound">n</a> <a id="996" class="Symbol">→</a> <a id="998" href="Data.Vec.Base.html#959" class="Datatype">Vec</a> <a id="1002" href="Tactic.RingSolver.Core.AlmostCommutativeRing.html#1379" class="Function">Carrier</a> <a id="1010" href="Tactic.RingSolver.Core.Polynomial.Semantics.html#980" class="Bound">n</a> <a id="1012" class="Symbol">→</a> <a id="1014" href="Tactic.RingSolver.Core.AlmostCommutativeRing.html#1379" class="Function">Carrier</a> <a id="1022" href="Data.Product.html#1167" class="Function Operator">×</a> <a id="1024" href="Data.Vec.Base.html#959" class="Datatype">Vec</a> <a id="1028" href="Tactic.RingSolver.Core.AlmostCommutativeRing.html#1379" class="Function">Carrier</a> <a id="1036" href="Tactic.RingSolver.Core.Polynomial.Semantics.html#978" class="Bound">i</a>
<a id="1038" href="Tactic.RingSolver.Core.Polynomial.Semantics.html#966" class="Function">drop-1</a> <a id="1045" href="Tactic.RingSolver.Core.Polynomial.Semantics.html#1045" class="Bound">si≤n</a> <a id="1050" href="Tactic.RingSolver.Core.Polynomial.Semantics.html#1050" class="Bound">xs</a> <a id="1053" class="Symbol">=</a> <a id="1055" href="Data.Vec.Base.html#7211" class="Function">uncons</a> <a id="1062" class="Symbol">(</a><a id="1063" href="Tactic.RingSolver.Core.Polynomial.Semantics.html#828" class="Function">drop</a> <a id="1068" href="Tactic.RingSolver.Core.Polynomial.Semantics.html#1045" class="Bound">si≤n</a> <a id="1073" href="Tactic.RingSolver.Core.Polynomial.Semantics.html#1050" class="Bound">xs</a><a id="1075" class="Symbol">)</a>
<a id="1077" class="Symbol">{-#</a> <a id="1081" class="Keyword">INLINE</a> <a id="1088" href="Tactic.RingSolver.Core.Polynomial.Semantics.html#966" class="Function">drop-1</a> <a id="1095" class="Symbol">#-}</a>

<a id="_*⟨_⟩^_"></a><a id="1100" href="Tactic.RingSolver.Core.Polynomial.Semantics.html#1100" class="Function Operator">_*⟨_⟩^_</a> <a id="1108" class="Symbol">:</a> <a id="1110" href="Tactic.RingSolver.Core.AlmostCommutativeRing.html#1379" class="Function">Carrier</a> <a id="1118" class="Symbol">→</a> <a id="1120" href="Tactic.RingSolver.Core.AlmostCommutativeRing.html#1379" class="Function">Carrier</a> <a id="1128" class="Symbol">→</a> <a id="1130" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a> <a id="1132" class="Symbol">→</a> <a id="1134" href="Tactic.RingSolver.Core.AlmostCommutativeRing.html#1379" class="Function">Carrier</a>
<a id="1142" href="Tactic.RingSolver.Core.Polynomial.Semantics.html#1142" class="Bound">x</a> <a id="1144" href="Tactic.RingSolver.Core.Polynomial.Semantics.html#1100" class="Function Operator">*⟨</a> <a id="1147" href="Tactic.RingSolver.Core.Polynomial.Semantics.html#1147" class="Bound">ρ</a> <a id="1149" href="Tactic.RingSolver.Core.Polynomial.Semantics.html#1100" class="Function Operator">⟩^</a> <a id="1152" href="Agda.Builtin.Nat.html#210" class="InductiveConstructor">zero</a> <a id="1157" class="Symbol">=</a> <a id="1159" href="Tactic.RingSolver.Core.Polynomial.Semantics.html#1142" class="Bound">x</a>
<a id="1161" href="Tactic.RingSolver.Core.Polynomial.Semantics.html#1161" class="Bound">x</a> <a id="1163" href="Tactic.RingSolver.Core.Polynomial.Semantics.html#1100" class="Function Operator">*⟨</a> <a id="1166" href="Tactic.RingSolver.Core.Polynomial.Semantics.html#1166" class="Bound">ρ</a> <a id="1168" href="Tactic.RingSolver.Core.Polynomial.Semantics.html#1100" class="Function Operator">⟩^</a> <a id="1171" href="Agda.Builtin.Nat.html#223" class="InductiveConstructor">suc</a> <a id="1175" href="Tactic.RingSolver.Core.Polynomial.Semantics.html#1175" class="Bound">i</a> <a id="1177" class="Symbol">=</a> <a id="1179" href="Tactic.RingSolver.Core.Polynomial.Semantics.html#1166" class="Bound">ρ</a> <a id="1181" href="Algebra.Operations.Ring.html#1130" class="Function Operator">^</a> <a id="1183" href="Tactic.RingSolver.Core.Polynomial.Semantics.html#1175" class="Bound">i</a> <a id="1185" href="Algebra.Operations.Ring.html#1130" class="Function Operator">+1</a> <a id="1188" href="Tactic.RingSolver.Core.AlmostCommutativeRing.html#1501" class="Function Operator">*</a> <a id="1190" href="Tactic.RingSolver.Core.Polynomial.Semantics.html#1161" class="Bound">x</a>
<a id="1192" class="Symbol">{-#</a> <a id="1196" class="Keyword">INLINE</a> <a id="1203" href="Tactic.RingSolver.Core.Polynomial.Semantics.html#1100" class="Function Operator">_*⟨_⟩^_</a> <a id="1211" class="Symbol">#-}</a>

<a id="1216" class="Comment">--------------------------------------------------------------------------------</a>
<a id="1297" class="Comment">-- Evaluation</a>
<a id="1311" class="Comment">--------------------------------------------------------------------------------</a>
<a id="1392" class="Comment">-- Why do we have three functions here? Why are they so weird looking?</a>
<a id="1463" class="Comment">--</a>
<a id="1466" class="Comment">-- These three functions are the main bottleneck for all of the proofs: as such,</a>
<a id="1547" class="Comment">-- slight changes can dramatically affect the length of proof code.</a>

<a id="1616" class="Keyword">mutual</a>

  <a id="_⟦∷⟧_"></a><a id="1626" href="Tactic.RingSolver.Core.Polynomial.Semantics.html#1626" class="Function Operator">_⟦∷⟧_</a> <a id="1632" class="Symbol">:</a> <a id="1634" class="Symbol">∀</a> <a id="1636" class="Symbol">{</a><a id="1637" href="Tactic.RingSolver.Core.Polynomial.Semantics.html#1637" class="Bound">n</a><a id="1638" class="Symbol">}</a> <a id="1640" class="Symbol">→</a> <a id="1642" href="Tactic.RingSolver.Core.Polynomial.Base.html#4173" class="Record">Poly</a> <a id="1647" href="Tactic.RingSolver.Core.Polynomial.Semantics.html#1637" class="Bound">n</a> <a id="1649" href="Data.Product.html#1167" class="Function Operator">×</a> <a id="1651" href="Tactic.RingSolver.Core.Polynomial.Base.html#4222" class="Function">Coeff</a> <a id="1657" href="Tactic.RingSolver.Core.Polynomial.Semantics.html#1637" class="Bound">n</a> <a id="1659" href="Data.List.Kleene.Base.html#1565" class="Datatype Operator">*</a> <a id="1661" class="Symbol">→</a> <a id="1663" href="Tactic.RingSolver.Core.AlmostCommutativeRing.html#1379" class="Function">Carrier</a> <a id="1671" href="Data.Product.html#1167" class="Function Operator">×</a> <a id="1673" href="Data.Vec.Base.html#959" class="Datatype">Vec</a> <a id="1677" href="Tactic.RingSolver.Core.AlmostCommutativeRing.html#1379" class="Function">Carrier</a> <a id="1685" href="Tactic.RingSolver.Core.Polynomial.Semantics.html#1637" class="Bound">n</a> <a id="1687" class="Symbol">→</a> <a id="1689" href="Tactic.RingSolver.Core.AlmostCommutativeRing.html#1379" class="Function">Carrier</a>
  <a id="1699" class="Symbol">(</a><a id="1700" href="Tactic.RingSolver.Core.Polynomial.Semantics.html#1700" class="Bound">x</a> <a id="1702" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="1704" href="Data.List.Kleene.Base.html#1739" class="InductiveConstructor">[]</a><a id="1706" class="Symbol">)</a>     <a id="1712" href="Tactic.RingSolver.Core.Polynomial.Semantics.html#1626" class="Function Operator">⟦∷⟧</a> <a id="1716" class="Symbol">(</a><a id="1717" href="Tactic.RingSolver.Core.Polynomial.Semantics.html#1717" class="Bound">ρ</a> <a id="1719" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="1721" href="Tactic.RingSolver.Core.Polynomial.Semantics.html#1721" class="Bound">ρs</a><a id="1723" class="Symbol">)</a> <a id="1725" class="Symbol">=</a> <a id="1727" href="Tactic.RingSolver.Core.Polynomial.Semantics.html#1955" class="Function Operator">⟦</a> <a id="1729" href="Tactic.RingSolver.Core.Polynomial.Semantics.html#1700" class="Bound">x</a> <a id="1731" href="Tactic.RingSolver.Core.Polynomial.Semantics.html#1955" class="Function Operator">⟧</a> <a id="1733" href="Tactic.RingSolver.Core.Polynomial.Semantics.html#1721" class="Bound">ρs</a>
  <a id="1738" class="Symbol">(</a><a id="1739" href="Tactic.RingSolver.Core.Polynomial.Semantics.html#1739" class="Bound">x</a> <a id="1741" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="1743" class="Symbol">(</a><a id="1744" href="Data.List.Kleene.Base.html#1750" class="InductiveConstructor Operator">∹</a> <a id="1746" href="Tactic.RingSolver.Core.Polynomial.Semantics.html#1746" class="Bound">xs</a><a id="1748" class="Symbol">))</a> <a id="1751" href="Tactic.RingSolver.Core.Polynomial.Semantics.html#1626" class="Function Operator">⟦∷⟧</a> <a id="1755" class="Symbol">(</a><a id="1756" href="Tactic.RingSolver.Core.Polynomial.Semantics.html#1756" class="Bound">ρ</a> <a id="1758" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="1760" href="Tactic.RingSolver.Core.Polynomial.Semantics.html#1760" class="Bound">ρs</a><a id="1762" class="Symbol">)</a> <a id="1764" class="Symbol">=</a> <a id="1766" href="Tactic.RingSolver.Core.Polynomial.Semantics.html#1756" class="Bound">ρ</a> <a id="1768" href="Tactic.RingSolver.Core.AlmostCommutativeRing.html#1501" class="Function Operator">*</a> <a id="1770" href="Tactic.RingSolver.Core.Polynomial.Semantics.html#1801" class="Function Operator">⅀⟦</a> <a id="1773" href="Tactic.RingSolver.Core.Polynomial.Semantics.html#1746" class="Bound">xs</a> <a id="1776" href="Tactic.RingSolver.Core.Polynomial.Semantics.html#1801" class="Function Operator">⟧</a> <a id="1778" class="Symbol">(</a><a id="1779" href="Tactic.RingSolver.Core.Polynomial.Semantics.html#1756" class="Bound">ρ</a> <a id="1781" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="1783" href="Tactic.RingSolver.Core.Polynomial.Semantics.html#1760" class="Bound">ρs</a><a id="1785" class="Symbol">)</a> <a id="1787" href="Tactic.RingSolver.Core.AlmostCommutativeRing.html#1459" class="Function Operator">+</a> <a id="1789" href="Tactic.RingSolver.Core.Polynomial.Semantics.html#1955" class="Function Operator">⟦</a> <a id="1791" href="Tactic.RingSolver.Core.Polynomial.Semantics.html#1739" class="Bound">x</a> <a id="1793" href="Tactic.RingSolver.Core.Polynomial.Semantics.html#1955" class="Function Operator">⟧</a> <a id="1795" href="Tactic.RingSolver.Core.Polynomial.Semantics.html#1760" class="Bound">ρs</a>

  <a id="⅀⟦_⟧"></a><a id="1801" href="Tactic.RingSolver.Core.Polynomial.Semantics.html#1801" class="Function Operator">⅀⟦_⟧</a> <a id="1806" class="Symbol">:</a> <a id="1808" class="Symbol">∀</a> <a id="1810" class="Symbol">{</a><a id="1811" href="Tactic.RingSolver.Core.Polynomial.Semantics.html#1811" class="Bound">n</a><a id="1812" class="Symbol">}</a> <a id="1814" class="Symbol">→</a> <a id="1816" href="Tactic.RingSolver.Core.Polynomial.Base.html#4222" class="Function">Coeff</a> <a id="1822" href="Tactic.RingSolver.Core.Polynomial.Semantics.html#1811" class="Bound">n</a> <a id="1824" href="Data.List.Kleene.Base.html#1533" class="Record Operator">+</a> <a id="1826" class="Symbol">→</a> <a id="1828" class="Symbol">(</a><a id="1829" href="Tactic.RingSolver.Core.AlmostCommutativeRing.html#1379" class="Function">Carrier</a> <a id="1837" href="Data.Product.html#1167" class="Function Operator">×</a> <a id="1839" href="Data.Vec.Base.html#959" class="Datatype">Vec</a> <a id="1843" href="Tactic.RingSolver.Core.AlmostCommutativeRing.html#1379" class="Function">Carrier</a> <a id="1851" href="Tactic.RingSolver.Core.Polynomial.Semantics.html#1811" class="Bound">n</a><a id="1852" class="Symbol">)</a> <a id="1854" class="Symbol">→</a> <a id="1856" href="Tactic.RingSolver.Core.AlmostCommutativeRing.html#1379" class="Function">Carrier</a>
  <a id="1866" href="Tactic.RingSolver.Core.Polynomial.Semantics.html#1801" class="Function Operator">⅀⟦</a> <a id="1869" href="Tactic.RingSolver.Core.Polynomial.Semantics.html#1869" class="Bound">x</a> <a id="1871" href="Tactic.RingSolver.Core.Polynomial.Base.html#4931" class="InductiveConstructor Operator">≠0</a> <a id="1874" href="Tactic.RingSolver.Core.Polynomial.Base.html#4105" class="InductiveConstructor Operator">Δ</a> <a id="1876" href="Tactic.RingSolver.Core.Polynomial.Semantics.html#1876" class="Bound">i</a> <a id="1878" href="Data.List.Kleene.Base.html#1656" class="InductiveConstructor Operator">&amp;</a> <a id="1880" href="Tactic.RingSolver.Core.Polynomial.Semantics.html#1880" class="Bound">xs</a> <a id="1883" href="Tactic.RingSolver.Core.Polynomial.Semantics.html#1801" class="Function Operator">⟧</a> <a id="1885" class="Symbol">(</a><a id="1886" href="Tactic.RingSolver.Core.Polynomial.Semantics.html#1886" class="Bound">ρ</a> <a id="1888" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="1890" href="Tactic.RingSolver.Core.Polynomial.Semantics.html#1890" class="Bound">ρs</a><a id="1892" class="Symbol">)</a> <a id="1894" class="Symbol">=</a> <a id="1896" class="Symbol">((</a><a id="1898" href="Tactic.RingSolver.Core.Polynomial.Semantics.html#1869" class="Bound">x</a> <a id="1900" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="1902" href="Tactic.RingSolver.Core.Polynomial.Semantics.html#1880" class="Bound">xs</a><a id="1904" class="Symbol">)</a> <a id="1906" href="Tactic.RingSolver.Core.Polynomial.Semantics.html#1626" class="Function Operator">⟦∷⟧</a> <a id="1910" class="Symbol">(</a><a id="1911" href="Tactic.RingSolver.Core.Polynomial.Semantics.html#1886" class="Bound">ρ</a> <a id="1913" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="1915" href="Tactic.RingSolver.Core.Polynomial.Semantics.html#1890" class="Bound">ρs</a><a id="1917" class="Symbol">))</a> <a id="1920" href="Tactic.RingSolver.Core.Polynomial.Semantics.html#1100" class="Function Operator">*⟨</a> <a id="1923" href="Tactic.RingSolver.Core.Polynomial.Semantics.html#1886" class="Bound">ρ</a> <a id="1925" href="Tactic.RingSolver.Core.Polynomial.Semantics.html#1100" class="Function Operator">⟩^</a> <a id="1928" href="Tactic.RingSolver.Core.Polynomial.Semantics.html#1876" class="Bound">i</a>
  <a id="1932" class="Symbol">{-#</a> <a id="1936" class="Keyword">INLINE</a> <a id="1943" href="Tactic.RingSolver.Core.Polynomial.Semantics.html#1801" class="Function Operator">⅀⟦_⟧</a> <a id="1948" class="Symbol">#-}</a>

  <a id="⟦_⟧"></a><a id="1955" href="Tactic.RingSolver.Core.Polynomial.Semantics.html#1955" class="Function Operator">⟦_⟧</a> <a id="1959" class="Symbol">:</a> <a id="1961" class="Symbol">∀</a> <a id="1963" class="Symbol">{</a><a id="1964" href="Tactic.RingSolver.Core.Polynomial.Semantics.html#1964" class="Bound">n</a><a id="1965" class="Symbol">}</a> <a id="1967" class="Symbol">→</a> <a id="1969" href="Tactic.RingSolver.Core.Polynomial.Base.html#4173" class="Record">Poly</a> <a id="1974" href="Tactic.RingSolver.Core.Polynomial.Semantics.html#1964" class="Bound">n</a> <a id="1976" class="Symbol">→</a> <a id="1978" href="Data.Vec.Base.html#959" class="Datatype">Vec</a> <a id="1982" href="Tactic.RingSolver.Core.AlmostCommutativeRing.html#1379" class="Function">Carrier</a> <a id="1990" href="Tactic.RingSolver.Core.Polynomial.Semantics.html#1964" class="Bound">n</a> <a id="1992" class="Symbol">→</a> <a id="1994" href="Tactic.RingSolver.Core.AlmostCommutativeRing.html#1379" class="Function">Carrier</a>
  <a id="2004" href="Tactic.RingSolver.Core.Polynomial.Semantics.html#1955" class="Function Operator">⟦</a> <a id="2006" href="Tactic.RingSolver.Core.Polynomial.Base.html#4605" class="InductiveConstructor">Κ</a> <a id="2008" href="Tactic.RingSolver.Core.Polynomial.Semantics.html#2008" class="Bound">x</a>  <a id="2011" href="Tactic.RingSolver.Core.Polynomial.Base.html#4465" class="InductiveConstructor Operator">⊐</a> <a id="2013" href="Tactic.RingSolver.Core.Polynomial.Semantics.html#2013" class="Bound">i≤n</a> <a id="2017" href="Tactic.RingSolver.Core.Polynomial.Semantics.html#1955" class="Function Operator">⟧</a> <a id="2019" class="Symbol">_</a> <a id="2021" class="Symbol">=</a> <a id="2023" href="Tactic.RingSolver.Core.Polynomial.Parameters.html#1431" class="Function Operator">⟦</a> <a id="2025" href="Tactic.RingSolver.Core.Polynomial.Semantics.html#2008" class="Bound">x</a> <a id="2027" href="Tactic.RingSolver.Core.Polynomial.Parameters.html#1431" class="Function Operator">⟧ᵣ</a>
  <a id="2032" href="Tactic.RingSolver.Core.Polynomial.Semantics.html#1955" class="Function Operator">⟦</a> <a id="2034" href="Tactic.RingSolver.Core.Polynomial.Base.html#4635" class="InductiveConstructor">⅀</a> <a id="2036" href="Tactic.RingSolver.Core.Polynomial.Semantics.html#2036" class="Bound">xs</a> <a id="2039" href="Tactic.RingSolver.Core.Polynomial.Base.html#4465" class="InductiveConstructor Operator">⊐</a> <a id="2041" href="Tactic.RingSolver.Core.Polynomial.Semantics.html#2041" class="Bound">i≤n</a> <a id="2045" href="Tactic.RingSolver.Core.Polynomial.Semantics.html#1955" class="Function Operator">⟧</a> <a id="2047" href="Tactic.RingSolver.Core.Polynomial.Semantics.html#2047" class="Bound">Ρ</a> <a id="2049" class="Symbol">=</a> <a id="2051" href="Tactic.RingSolver.Core.Polynomial.Semantics.html#1801" class="Function Operator">⅀⟦</a> <a id="2054" href="Tactic.RingSolver.Core.Polynomial.Semantics.html#2036" class="Bound">xs</a> <a id="2057" href="Tactic.RingSolver.Core.Polynomial.Semantics.html#1801" class="Function Operator">⟧</a> <a id="2059" class="Symbol">(</a><a id="2060" href="Tactic.RingSolver.Core.Polynomial.Semantics.html#966" class="Function">drop-1</a> <a id="2067" href="Tactic.RingSolver.Core.Polynomial.Semantics.html#2041" class="Bound">i≤n</a> <a id="2071" href="Tactic.RingSolver.Core.Polynomial.Semantics.html#2047" class="Bound">Ρ</a><a id="2072" class="Symbol">)</a>
  <a id="2076" class="Symbol">{-#</a> <a id="2080" class="Keyword">INLINE</a> <a id="2087" href="Tactic.RingSolver.Core.Polynomial.Semantics.html#1955" class="Function Operator">⟦_⟧</a> <a id="2091" class="Symbol">#-}</a>

<a id="2096" class="Comment">--------------------------------------------------------------------------------</a>
<a id="2177" class="Comment">-- Performance</a>
<a id="2192" class="Comment">--------------------------------------------------------------------------------</a>
<a id="2273" class="Comment">-- As you might imagine, the implementation of the functions above seriously</a>
<a id="2350" class="Comment">-- affect performance. What you might not realise, though, is that the most</a>
<a id="2426" class="Comment">-- important component is the *order of the arguments*. For instance, if</a>
<a id="2499" class="Comment">-- we change:</a>
<a id="2513" class="Comment">--</a>
<a id="2516" class="Comment">--   (x , xs) ⟦∷⟧ (ρ , ρs) = ρ * ⅀⟦ xs ⟧ (ρ , ρs) + ⟦ x ⟧ ρs</a>
<a id="2577" class="Comment">--</a>
<a id="2580" class="Comment">-- To:</a>
<a id="2587" class="Comment">--</a>
<a id="2590" class="Comment">--   (x , xs) ⟦∷⟧ (ρ , ρs) = ⟦ x ⟧ ρs +  ⅀⟦ xs ⟧ (ρ , ρs) * ρ</a>
<a id="2652" class="Comment">--</a>
<a id="2655" class="Comment">-- We get a function that&#39;s several orders of magnitude slower!</a>
</pre></body></html>