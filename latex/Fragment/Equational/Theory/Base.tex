\begin{code}[hidden]%
\>[0]\AgdaSymbol{\{-\#}\AgdaSpace{}%
\AgdaKeyword{OPTIONS}\AgdaSpace{}%
\AgdaPragma{--without-K}\AgdaSpace{}%
\AgdaPragma{--safe}\AgdaSpace{}%
\AgdaSymbol{\#-\}}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaKeyword{module}\AgdaSpace{}%
\AgdaModule{Fragment.Equational.Theory.Base}\AgdaSpace{}%
\AgdaKeyword{where}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaKeyword{import}\AgdaSpace{}%
\AgdaModule{Function}\AgdaSpace{}%
\AgdaKeyword{using}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaOperator{\AgdaFunction{\AgdaUnderscore{}∘\AgdaUnderscore{}}}\AgdaSymbol{)}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaKeyword{import}\AgdaSpace{}%
\AgdaModule{Fragment.Algebra.Signature}\<%
\\
\>[0]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaKeyword{import}\AgdaSpace{}%
\AgdaModule{Fragment.Algebra.Free}\<%
\\
\>[0]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaKeyword{import}\AgdaSpace{}%
\AgdaModule{Fragment.Algebra.Algebra}\<%
\\
\>[0]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaKeyword{import}\AgdaSpace{}%
\AgdaModule{Fragment.Algebra.Properties}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaKeyword{import}\AgdaSpace{}%
\AgdaModule{Data.Nat}\AgdaSpace{}%
\AgdaKeyword{using}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaDatatype{ℕ}\AgdaSymbol{)}\<%
\\
\>[0]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaKeyword{import}\AgdaSpace{}%
\AgdaModule{Data.Fin}\AgdaSpace{}%
\AgdaKeyword{using}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaDatatype{Fin}\AgdaSymbol{)}\<%
\\
\>[0]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaKeyword{import}\AgdaSpace{}%
\AgdaModule{Data.Product}\AgdaSpace{}%
\AgdaKeyword{using}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaOperator{\AgdaFunction{\AgdaUnderscore{}×\AgdaUnderscore{}}}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaFunction{map}\AgdaSymbol{)}\<%
\end{code}

%<*equation>
\begin{code}%
\>[0]\AgdaFunction{Eq}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{Σ}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaRecord{Signature}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{n}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{ℕ}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaPrimitiveType{Set}\<%
\\
\>[0]\AgdaFunction{Eq}\AgdaSpace{}%
\AgdaBound{Σ}\AgdaSpace{}%
\AgdaBound{n}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{∥}}\AgdaSpace{}%
\AgdaFunction{F}\AgdaSpace{}%
\AgdaBound{Σ}\AgdaSpace{}%
\AgdaBound{n}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{∥}}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{×}}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{∥}}\AgdaSpace{}%
\AgdaFunction{F}\AgdaSpace{}%
\AgdaBound{Σ}\AgdaSpace{}%
\AgdaBound{n}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{∥}}\<%
\end{code}
%</equation>

%<*theory>
\begin{code}%
\>[0]\AgdaKeyword{record}\AgdaSpace{}%
\AgdaRecord{Theory}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaPrimitiveType{Set₁}\AgdaSpace{}%
\AgdaKeyword{where}\<%
\\
\>[0][@{}l@{\AgdaIndent{0}}]%
\>[2]\AgdaKeyword{field}\<%
\\
\>[2][@{}l@{\AgdaIndent{0}}]%
\>[4]\AgdaField{Σ}%
\>[10]\AgdaSymbol{:}\AgdaSpace{}%
\AgdaRecord{Signature}\<%
\\
%
\>[4]\AgdaField{eqs}%
\>[10]\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{ℕ}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaPrimitiveType{Set}\<%
\\
%
\>[4]\AgdaOperator{\AgdaField{\AgdaUnderscore{}⟦\AgdaUnderscore{}⟧ₑ}}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{∀}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{arity}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaField{eqs}\AgdaSpace{}%
\AgdaBound{arity}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaFunction{Eq}\AgdaSpace{}%
\AgdaField{Σ}\AgdaSpace{}%
\AgdaBound{arity}\<%
\end{code}
%</theory>

\begin{code}[hidden]%
%
\>[2]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaModule{Signature}\AgdaSpace{}%
\AgdaField{Σ}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaModule{Theory}\AgdaSpace{}%
\AgdaKeyword{public}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaKeyword{data}\AgdaSpace{}%
\AgdaDatatype{ExtendedEq}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{Θ}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaRecord{Theory}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{E}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{ℕ}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaPrimitiveType{Set}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{ℕ}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaPrimitiveType{Set}\AgdaSpace{}%
\AgdaKeyword{where}\<%
\\
\>[0][@{}l@{\AgdaIndent{0}}]%
\>[2]\AgdaInductiveConstructor{new}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{∀}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{n}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaBound{E}\AgdaSpace{}%
\AgdaBound{n}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaDatatype{ExtendedEq}\AgdaSpace{}%
\AgdaBound{Θ}\AgdaSpace{}%
\AgdaBound{E}\AgdaSpace{}%
\AgdaBound{n}\<%
\\
%
\>[2]\AgdaInductiveConstructor{old}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{∀}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{n}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaField{eqs}\AgdaSpace{}%
\AgdaBound{Θ}\AgdaSpace{}%
\AgdaBound{n}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaDatatype{ExtendedEq}\AgdaSpace{}%
\AgdaBound{Θ}\AgdaSpace{}%
\AgdaBound{E}\AgdaSpace{}%
\AgdaBound{n}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaOperator{\AgdaFunction{\AgdaUnderscore{}⦅\AgdaUnderscore{}⦆ₒ}}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{Θ}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaRecord{Theory}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{O}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{ℕ}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaPrimitiveType{Set}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaRecord{Theory}\<%
\\
\>[0]\AgdaBound{Θ}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{⦅}}\AgdaSpace{}%
\AgdaBound{O}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{⦆ₒ}}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaKeyword{record}%
\>[131I]\AgdaSymbol{\{}\AgdaSpace{}%
\AgdaField{Σ}%
\>[26]\AgdaSymbol{=}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaField{Σ}\AgdaSpace{}%
\AgdaBound{Θ}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{⦅}}\AgdaSpace{}%
\AgdaBound{O}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{⦆}}\<%
\\
\>[.][@{}l@{}]\<[131I]%
\>[18]\AgdaSymbol{;}\AgdaSpace{}%
\AgdaField{eqs}%
\>[26]\AgdaSymbol{=}\AgdaSpace{}%
\AgdaField{eqs}\AgdaSpace{}%
\AgdaBound{Θ}\<%
\\
%
\>[18]\AgdaSymbol{;}\AgdaSpace{}%
\AgdaOperator{\AgdaField{\AgdaUnderscore{}⟦\AgdaUnderscore{}⟧ₑ}}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{map}\AgdaSpace{}%
\AgdaFunction{extend}\AgdaSpace{}%
\AgdaFunction{extend}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{∘}}\AgdaSpace{}%
\AgdaBound{Θ}\AgdaSpace{}%
\AgdaOperator{\AgdaField{⟦\AgdaUnderscore{}⟧ₑ}}\<%
\\
%
\>[18]\AgdaSymbol{\}}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaOperator{\AgdaFunction{\AgdaUnderscore{}⦅\AgdaUnderscore{}/\AgdaUnderscore{}⦆}}\AgdaSpace{}%
\AgdaSymbol{:}%
\>[150I]\AgdaSymbol{(}\AgdaBound{Θ}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaRecord{Theory}\AgdaSymbol{)}\<%
\\
\>[.][@{}l@{}]\<[150I]%
\>[9]\AgdaSymbol{→}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{E}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{ℕ}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaPrimitiveType{Set}\AgdaSymbol{)}\<%
\\
%
\>[9]\AgdaSymbol{→}\AgdaSpace{}%
\AgdaSymbol{(∀}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{n}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaBound{E}\AgdaSpace{}%
\AgdaBound{n}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaFunction{Eq}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaField{Σ}\AgdaSpace{}%
\AgdaBound{Θ}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{n}\AgdaSymbol{)}\<%
\\
%
\>[9]\AgdaSymbol{→}\AgdaSpace{}%
\AgdaRecord{Theory}\<%
\\
\>[0]\AgdaBound{Θ}%
\>[169I]\AgdaOperator{\AgdaFunction{⦅}}\AgdaSpace{}%
\AgdaBound{E}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{/}}\AgdaSpace{}%
\AgdaOperator{\AgdaBound{⟦\AgdaUnderscore{}⟧'}}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{⦆}}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaKeyword{record}%
\>[176I]\AgdaSymbol{\{}\AgdaSpace{}%
\AgdaField{Σ}%
\>[32]\AgdaSymbol{=}\AgdaSpace{}%
\AgdaField{Σ}\AgdaSpace{}%
\AgdaBound{Θ}\<%
\\
\>[.][@{}l@{}]\<[176I]%
\>[24]\AgdaSymbol{;}\AgdaSpace{}%
\AgdaField{eqs}%
\>[32]\AgdaSymbol{=}\AgdaSpace{}%
\AgdaDatatype{ExtendedEq}\AgdaSpace{}%
\AgdaBound{Θ}\AgdaSpace{}%
\AgdaBound{E}\<%
\\
%
\>[24]\AgdaSymbol{;}\AgdaSpace{}%
\AgdaOperator{\AgdaField{\AgdaUnderscore{}⟦\AgdaUnderscore{}⟧ₑ}}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{withE}\<%
\\
%
\>[24]\AgdaSymbol{\}}\<%
\\
\>[.][@{}l@{}]\<[169I]%
\>[2]\AgdaKeyword{where}%
\>[187I]\AgdaFunction{withE}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{∀}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{n}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaDatatype{ExtendedEq}\AgdaSpace{}%
\AgdaBound{Θ}\AgdaSpace{}%
\AgdaBound{E}\AgdaSpace{}%
\AgdaBound{n}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaFunction{Eq}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaField{Σ}\AgdaSpace{}%
\AgdaBound{Θ}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{n}\<%
\\
\>[.][@{}l@{}]\<[187I]%
\>[8]\AgdaFunction{withE}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{new}\AgdaSpace{}%
\AgdaBound{eq}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaOperator{\AgdaBound{⟦}}\AgdaSpace{}%
\AgdaBound{eq}\AgdaSpace{}%
\AgdaOperator{\AgdaBound{⟧'}}\<%
\\
%
\>[8]\AgdaFunction{withE}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaInductiveConstructor{old}\AgdaSpace{}%
\AgdaBound{eq}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaBound{Θ}\AgdaSpace{}%
\AgdaOperator{\AgdaField{⟦}}\AgdaSpace{}%
\AgdaBound{eq}\AgdaSpace{}%
\AgdaOperator{\AgdaField{⟧ₑ}}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0]\AgdaOperator{\AgdaFunction{\AgdaUnderscore{}⦅\AgdaUnderscore{}∣\AgdaUnderscore{}/\AgdaUnderscore{}⦆}}\AgdaSpace{}%
\AgdaSymbol{:}%
\>[215I]\AgdaSymbol{(}\AgdaBound{Θ}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaRecord{Theory}\AgdaSymbol{)}\<%
\\
\>[.][@{}l@{}]\<[215I]%
\>[11]\AgdaSymbol{→}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{O}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{ℕ}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaPrimitiveType{Set}\AgdaSymbol{)}\<%
\\
%
\>[11]\AgdaSymbol{→}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{E}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{ℕ}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaPrimitiveType{Set}\AgdaSymbol{)}\<%
\\
%
\>[11]\AgdaSymbol{→}\AgdaSpace{}%
\AgdaSymbol{(∀}\AgdaSpace{}%
\AgdaSymbol{\{}\AgdaBound{n}\AgdaSymbol{\}}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaBound{E}\AgdaSpace{}%
\AgdaBound{n}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaFunction{Eq}\AgdaSpace{}%
\AgdaSymbol{((}\AgdaField{Σ}\AgdaSpace{}%
\AgdaBound{Θ}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{⦅}}\AgdaSpace{}%
\AgdaBound{O}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{⦆}}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{n}\AgdaSymbol{)}\<%
\\
%
\>[11]\AgdaSymbol{→}\AgdaSpace{}%
\AgdaRecord{Theory}\<%
\\
\>[0]\AgdaBound{Θ}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{⦅}}\AgdaSpace{}%
\AgdaBound{O}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{∣}}\AgdaSpace{}%
\AgdaBound{E}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{/}}\AgdaSpace{}%
\AgdaOperator{\AgdaBound{⟦\AgdaUnderscore{}⟧'}}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{⦆}}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{Θ}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{⦅}}\AgdaSpace{}%
\AgdaBound{O}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{⦆ₒ}}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{⦅}}\AgdaSpace{}%
\AgdaBound{E}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{/}}\AgdaSpace{}%
\AgdaOperator{\AgdaBound{⟦\AgdaUnderscore{}⟧'}}\AgdaSpace{}%
\AgdaOperator{\AgdaFunction{⦆}}\<%
\end{code}
